@using CSharpSoChiTieu.Business.Services


<!-- Small Action Dialog -->
<div id="actionDialog" class="position-fixed bg-white shadow-sm rounded" style="display: none; z-index: 1000; min-width: 120px;">
	<ul class="list-group list-group-flush">
		<li class="list-group-item py-1 px-2 action-edit" style="cursor: pointer; font-size: 0.875rem;">
			<i class="material-symbols-rounded align-middle me-1" style="font-size: 1rem;">edit</i>
			Chỉnh sửa
		</li>
		<li class="list-group-item py-1 px-2 action-delete" style="cursor: pointer; font-size: 0.875rem;">
			<i class="material-symbols-rounded align-middle me-1" style="font-size: 1rem;">delete</i>
			Xóa
		</li>
	</ul>
</div>

<!-- Modal Dialog -->
<div class="modal fade" id="incomeExpenseModal" tabindex="-1" aria-labelledby="incomeExpenseModalLabel" aria-hidden="true">
	<div class="modal-dialog modal-dialog-centered">
		<div class="modal-content">
			<div class="modal-header">
				<h5 class="modal-title" id="incomeExpenseModalLabel">Chỉnh sửa thu chi</h5>
				<button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
			</div>
			<div class="modal-body">
				<form id="incomeExpenseForm">
					<input type="hidden" id="itemId" name="id" />

					@* Loại thu chi *@
					<div class="d-flex align-items-center mb-3">
						<label for="typeSelect" class="form-label small fw-bold mb-0 me-3 text-nowrap flex-shrink-0" style="width: 70px;">Loại <span class="text-danger">*</span></label>
						<div class="input-group input-group-static flex-grow-1">
							<span class="input-group-text"><i class="fas fa-exchange-alt"></i></span>
							<select id="typeSelect" name="type" class="form-select" required>
								<option value="Income">Thu</option>
								<option value="Expense">Chi</option>
							</select>
						</div>
					</div>

					@* Ngày *@
					<div class="d-flex align-items-center mb-3">
						<label for="income-date" class="form-label small fw-bold mb-0 me-3 text-nowrap flex-shrink-0" style="width: 70px;">Ngày <span class="text-danger">*</span></label>
						<div class="input-group input-group-static flex-grow-1">
							<span class="input-group-text"><i class="fas fa-calendar-day"></i></span>
							<input type="date" class="form-control" id="income-date" name="IncomeDate" required value="@DateTime.UtcNow.ToString("yyyy-MM-dd")">
						</div>
					</div>

					@* Ghi chú *@
					<div class="d-flex align-items-center mb-3">
						<label for="income-note" class="form-label small fw-bold mb-0 me-3 text-nowrap flex-shrink-0" style="width: 70px;">Ghi chú </label>
						<div class="input-group input-group-static flex-grow-1">
							<span class="input-group-text"><i class="fas fa-pencil-alt"></i></span>
							<input type="text" class="form-control" id="income-note" name="Note" placeholder="Ghi chú">
						</div>
					</div>

					@* Số tiền và tiền tệ *@
					<div class="d-flex align-items-center mb-3">
						<label for="income-amount" class="form-label small fw-bold mb-0 me-3 text-nowrap flex-shrink-0" style="width: 70px;">Số tiền <span class="text-danger">*</span></label>
						<div class="input-group input-group-static flex-grow-1">
							<input type="text" class="form-control" id="income-amount" name="Amount" placeholder="0" required inputmode="decimal" onkeyup="formatNumber(this)">
							<select class="form-select border-start-0 rounded-start-0"
									name="Currency"
									id="transaction-currency"
									style="max-width: 90px;">
								@if (ViewBag.Currencies != null)
								{
									var selectedCurrency = ViewBag.SelectedCurrency as string;
									foreach (var currency in (List<CurrencyViewModel>)ViewBag.Currencies)
									{
										<option value="@currency.Code" selected="@(currency.Code == selectedCurrency ? "selected" : null)">
											@currency.Code
										</option>
									}
								}
							</select>
						</div>
					</div>

					@* Danh mục *@
					<div class="d-flex align-items-center mb-3">
						<label for="income-category" class="form-label small fw-bold mb-0 me-3 text-nowrap flex-shrink-0" style="width: 70px;">Danh mục <span class="text-danger">*</span></label>
						<div class="input-group input-group-static flex-grow-1">
							<span class="input-group-text"><i class="fas fa-tags"></i></span>
							<select class="form-select" id="income-category" name="CategoryId" required>
								<option value="">Chọn danh mục</option>
							</select>
						</div>
					</div>
				</form>
			</div>
			<div class="modal-footer">
				<button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Đóng</button>
				<button type="button" class="btn btn-primary" id="btnSave">Lưu</button>
			</div>
		</div>
	</div>
</div>

<style>
	.action-edit:hover {
		background-color: #f8f9fa;
	}

	.action-delete:hover {
		background-color: #f8f9fa;
		color: #dc3545;
	}

	#actionDialog {
		border: 1px solid rgba(0,0,0,.1);
	}

		#actionDialog .list-group-item {
			border: none;
			border-radius: 0;
		}

			#actionDialog .list-group-item:first-child {
				border-top-left-radius: 0.25rem;
				border-top-right-radius: 0.25rem;
			}

			#actionDialog .list-group-item:last-child {
				border-bottom-left-radius: 0.25rem;
				border-bottom-right-radius: 0.25rem;
			}

	#income-category {
		padding-left: 2.5rem;
	}

		#income-category option {
			padding-left: 2.5rem;
			position: relative;
		}

			#income-category option::before {
				content: attr(data-icon);
				position: absolute;
				left: 0.5rem;
				top: 50%;
				transform: translateY(-50%);
				width: 1.5rem;
				height: 1.5rem;
				display: flex;
				align-items: center;
				justify-content: center;
				background-color: var(--category-color);
				border-radius: 50%;
				color: white;
				font-size: 0.875rem;
			}

	/* Styling cho input group với select */
	.input-group .form-select {
		border-left: 0;
	}

	.input-group .form-control:focus + .form-select {
		border-color: #5e72e4;
		box-shadow: 0 0 0 0.2rem rgba(94, 114, 228, 0.25);
	}
</style> 